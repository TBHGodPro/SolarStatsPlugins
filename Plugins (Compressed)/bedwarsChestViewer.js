const{Command,Inventory,Item}=toolbox,{InventoryType}=requireModule("../Types"),ECCommand=new Command("ec",[],[]),TCCommand=new Command("tc",[],[]);let heldItem=null,ECwindowId=null,ECitems=[],TCwindowId=null,TCitems=[];player.proxy.on("incoming",(a,b)=>{"open_window"==b.name&&("container.enderchest"==JSON.parse(a.windowTitle).translate&&(ECwindowId=a.windowId),"container.chest"==JSON.parse(a.windowTitle).translate&&(TCwindowId=a.windowId)),"window_items"==b.name&&(ECwindowId==a.windowId||TCwindowId==a.windowId)&&(ECwindowId==a.windowId?ECitems=a.items:TCitems=a.items)}),player.proxy.on("outgoing",(a,b)=>{if("window_click"==b.name){if(ECwindowId==a.windowId||TCwindowId==a.windowId){var c=a.slot;if(ECwindowId==a.windowId){if(26<a.slot&&1==a.mode){if(heldItem=a.item,a.slot=ECitems.indexOf(ECitems.find(b=>b.blockId==a.item.blockId&&b.itemDamage==a.item.itemDamage&&b.nbtData==a.item.nbtData&&64>b.itemCount)),(-1==a.slot||26<a.slot)&&(a.slot=ECitems.indexOf(ECitems.find(a=>-1==a.blockId))),26<a.slot)return;}else if(1==a.mode)return void(ECitems[a.slot]={blockId:-1,itemCount:void 0,itemDamage:void 0,nbtData:void 0});ECitems[a.slot]?.itemCount&&26<c?ECitems[a.slot].itemCount+=a.item.itemCount:ECitems[a.slot]=a.item}else{if(26<a.slot&&1==a.mode){if(heldItem=a.item,a.slot=TCitems.indexOf(TCitems.find(b=>b.blockId==a.item.blockId&&b.itemDamage==a.item.itemDamage&&b.nbtData==a.item.nbtData&&64>b.itemCount)),(-1==a.slot||26<a.slot)&&(a.slot=TCitems.indexOf(TCitems.find(a=>-1==a.blockId))),26<a.slot)return;}else if(1==a.mode)return void(TCitems[a.slot]={blockId:-1,itemCount:void 0,itemDamage:void 0,nbtData:void 0});TCitems[a.slot]?.itemCount&&26<c?TCitems[a.slot].itemCount+=a.item.itemCount:TCitems[a.slot]=a.item}}heldItem=a.item}}),ECCommand.onTriggered=async()=>{if(ECitems?.length){const c=new Inventory(InventoryType.CONTAINER,"\xA75\xA7lEnder Chest \xA7r\xA7f(At Last View)",27);for(var a of ECitems){var b=new Item(a?.blockId,a?.itemCount);b.meta=a?.itemDamage,a?.nbtData?.value?.display?.value?.Name?.value&&(b.displayName=a?.nbtData?.value?.display?.value?.Name?.value),a?.nbtData?.value?.display?.value?.Lore?.value?.value&&(b.lore=a?.nbtData?.value?.display?.value?.Lore?.value?.value),c.addItem(b,ECitems.indexOf(a))}c.on("click",a=>a.cancel(player.client)),c.display(player)}},TCCommand.onTriggered=async()=>{if(TCitems?.length){const c=new Inventory(InventoryType.CONTAINER,"\xA7a\xA7lTeam Chest \xA7r\xA7f(At Last View)",27);for(var a of TCitems){var b=new Item(a?.blockId,a?.itemCount);b.meta=a?.itemDamage,a?.nbtData?.value?.display?.value?.Name?.value&&(b.displayName=a?.nbtData?.value?.display?.value?.Name?.value),a?.nbtData?.value?.display?.value?.Lore?.value?.value&&(b.lore=a?.nbtData?.value?.display?.value?.Lore?.value?.value),c.addItem(b,TCitems.indexOf(a))}c.on("click",a=>a.cancel(player.client)),c.display(player)}},registerCommand(ECCommand),registerCommand(TCCommand),registerPlugin({name:"Bedwars Chest Viewer",description:"View Your Ender Chest And Team Chest From Anywhere",version:"1.0.0",author:"TBHGodPro"});