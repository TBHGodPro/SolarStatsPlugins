const{Command:a,Inventory:b,Item:c}=toolbox,{InventoryType:d}=requireModule("../Types"),ECCommand=new a("ec",[],[]),TCCommand=new a("tc",[],[]);let heldItem=null,ECwindowId=null,ECitems=[],TCwindowId=null,TCitems=[];player.proxy.on("incoming",(a,b)=>{"open_window"==b.name&&("container.enderchest"==JSON.parse(a.windowTitle).translate&&(ECwindowId=a.windowId),"container.chest"==JSON.parse(a.windowTitle).translate&&(TCwindowId=a.windowId)),"window_items"==b.name&&(ECwindowId==a.windowId||TCwindowId==a.windowId)&&(ECwindowId==a.windowId?ECitems=a.items:TCitems=a.items)}),player.proxy.on("outgoing",(a,c)=>{if("window_click"==c.name){if(ECwindowId==a.windowId||TCwindowId==a.windowId){var b=a.slot;if(ECwindowId==a.windowId){if(a.slot>26&&1==a.mode){if(heldItem=a.item,a.slot=ECitems.indexOf(ECitems.find(b=>b.blockId==a.item.blockId&&b.itemDamage==a.item.itemDamage&&b.nbtData==a.item.nbtData&&b.itemCount<64)),(-1==a.slot||a.slot>26)&&(a.slot=ECitems.indexOf(ECitems.find(a=>-1==a.blockId))),a.slot>26)return}else if(1==a.mode){ECitems[a.slot]={blockId:-1,itemCount:void 0,itemDamage:void 0,nbtData:void 0};return}ECitems[a.slot]?.itemCount&&b>26?ECitems[a.slot].itemCount+=a.item.itemCount:ECitems[a.slot]=a.item}else{if(a.slot>26&&1==a.mode){if(heldItem=a.item,a.slot=TCitems.indexOf(TCitems.find(b=>b.blockId==a.item.blockId&&b.itemDamage==a.item.itemDamage&&b.nbtData==a.item.nbtData&&b.itemCount<64)),(-1==a.slot||a.slot>26)&&(a.slot=TCitems.indexOf(TCitems.find(a=>-1==a.blockId))),a.slot>26)return}else if(1==a.mode){TCitems[a.slot]={blockId:-1,itemCount:void 0,itemDamage:void 0,nbtData:void 0};return}TCitems[a.slot]?.itemCount&&b>26?TCitems[a.slot].itemCount+=a.item.itemCount:TCitems[a.slot]=a.item}}heldItem=a.item}}),ECCommand.onTriggered=async()=>{if(ECitems?.length){let f=new b(d.CONTAINER,"\xa75\xa7lEnder Chest \xa7r\xa7f(At Last View)",27);for(var a of ECitems){var e=new c(a?.blockId,a?.itemCount);e.meta=a?.itemDamage,a?.nbtData?.value?.display?.value?.Name?.value&&(e.displayName=a?.nbtData?.value?.display?.value?.Name?.value),a?.nbtData?.value?.display?.value?.Lore?.value?.value&&(e.lore=a?.nbtData?.value?.display?.value?.Lore?.value?.value),f.addItem(e,ECitems.indexOf(a))}f.on("click",a=>a.cancel(player.client)),f.display(player)}},TCCommand.onTriggered=async()=>{if(TCitems?.length){let f=new b(d.CONTAINER,"\xa7a\xa7lTeam Chest \xa7r\xa7f(At Last View)",27);for(var a of TCitems){var e=new c(a?.blockId,a?.itemCount);e.meta=a?.itemDamage,a?.nbtData?.value?.display?.value?.Name?.value&&(e.displayName=a?.nbtData?.value?.display?.value?.Name?.value),a?.nbtData?.value?.display?.value?.Lore?.value?.value&&(e.lore=a?.nbtData?.value?.display?.value?.Lore?.value?.value),f.addItem(e,TCitems.indexOf(a))}f.on("click",a=>a.cancel(player.client)),f.display(player)}},registerCommand(ECCommand),registerCommand(TCCommand),registerPlugin({name:"Bedwars Chest Viewer",description:"View Your Ender Chest And Team Chest From Anywhere | `/ec` `/tc`",version:"1.2.1",author:"TBHGodPro"})