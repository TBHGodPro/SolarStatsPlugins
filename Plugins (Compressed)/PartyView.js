(()=>{const e=e=>player.connectedPlayers.find((a=>a.name==e))?.uuid,a=new toolbox.Item(4);a.displayName="§rParty View",a.lore=["","§7Use The Lunar Client Team View","§7Mod To See Your Party Members","","§7Current: §"+(toolbox.getConfigSync().modules.PartyView?"aEnabled":"cDisabled")];const r=new toolbox.PlayerModule("Party View","View Your Party Members With LC Team View",a,"PartyView");var t=null,l=toolbox.getConfigSync(),i=[];r.customCode=()=>{player.proxy.on("incoming",((a,r,t,s)=>{if("chat"==r.name){var o=JSON.parse(a.message);o.extra??=[];var n=[o.text,...o.extra.map((e=>e.text))].join("");if(n.endsWith("joined the party.")&&(m=(m=n.split(" ")).splice(m[0].startsWith("[")?1:0,m.length-(m[0].startsWith("[")?4:3)).join(" "),i.push(m),l.modules.PartyView)){if(!(d=e(m)))return;player.lcPlayer?.addTeammate(d)}if(n.endsWith("left the party.")&&!n.startsWith("You")&&(m=(m=n.split(" ")).splice(m[0].startsWith("[")?1:0,m.length-(m[0].startsWith("[")?4:3)).join(" "),i=i.filter((e=>e!=m)),l.modules.PartyView)){if(!(d=e(m)))return;player.lcPlayer?.removeTeammate(d)}if((n.includes("has disbanded the party!")||n.includes("You left the party."))&&(i=[],player.lcPlayer?.removeAllTeammates()),n.includes("You have joined")&&n.includes("party!")&&setTimeout((()=>player.executeCommand("/p list")),1e3),n.includes("Party Leader:")&&(m=(m=n.split(" ")).splice(m[0].startsWith("[")?4:3,m.length-(m[0].startsWith("[")?5:4)).join(" "),i=[],player.lcPlayer?.removeAllTeammates(),i.push(m),l.modules.PartyView)){if(!(d=e(m)))return;player.lcPlayer?.addTeammate(d)}if(n.includes("Party Moderators:")||n.includes("Party Members:")){var y=n.split(" ");if(y=y.splice(2,y.length).join(" ").split("● ").map((e=>e.split(" ").splice(y[0].startsWith("[")?2:1,y.length-(y[0].startsWith("[")?2:1)).join(" "))),(i=[]).push(y),l.modules.PartyView)for(var m of y){var d;if(!(d=e(m)))return;player.lcPlayer?.addTeammate(d)}}n.includes("You are not currently in a party.")&&(i=[],player.lcPlayer?.removeAllTeammates())}})),setInterval((async()=>{t=l,l=await toolbox.getConfig(),JSON.stringify(t)!=JSON.stringify(l)&&(l.modules.PartyView?(player.lcPlayer?.removeAllTeammates(),i.forEach((a=>{var r=e(a);r&&player.lcPlayer?.addTeammate(r)}))):player.lcPlayer?.removeAllTeammates())}),500)},player.listener.on("switch_server",(()=>{l.modules.PartyView&&(player.lcPlayer?.removeAllTeammates(),i.forEach((a=>{var r=e(a);r&&player.lcPlayer?.addTeammate(r)})))})),player.listener.on("player_join",((e,a)=>{l.modules.PartyView&&i.includes(a)&&e&&player.lcPlayer?.addTeammate(e)})),registerPlayerModule(r),registerPlugin({name:"Party View",description:"View Your Party Members With LC Team View | `/ss`",version:"1.4.1",author:"TBHGodPro"})})();