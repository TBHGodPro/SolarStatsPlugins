const getUUID=a=>player.connectedPlayers.find(b=>b.name==a)?.uuid,settingItem=new toolbox.Item(4);settingItem.displayName="Party View",settingItem.lore=["","\xA77Use The Lunar Client Team View","\xA77Mod To See Your Party Members","",`ยง7Current: ยง${toolbox.getConfigSync().modules.PartyView?"aEnabled":"cDisabled"}`];const module=new toolbox.PlayerModule("Party View","View Your Party Members With LC Team View",settingItem,"PartyView");var oldConfig=null,config=toolbox.getConfigSync(),partyMembers=[];module.customCode=()=>{player.proxy.on("incoming",async(a,b)=>{if("chat"==b.name){var c=JSON.parse(a.message);c.extra??=[];var d=[c.text,...c.extra.map(a=>a.text)].join("");if(d.endsWith("joined the party.")){var e=d.split(" ");if(e=e.splice(e[0].startsWith("[")?1:0,e.length-(e[0].startsWith("[")?4:3)).join(" "),partyMembers.push(e),config.modules.PartyView){var f=getUUID(e);if(!f)return;player.lcPlayer.addTeammate(f)}}if(d.endsWith("left the party.")){var e=d.split(" ");if(e=e.splice(e[0].startsWith("[")?1:0,e.length-(e[0].startsWith("[")?4:3)).join(" "),partyMembers=partyMembers.filter(a=>a!=e),config.modules.PartyView){var f=getUUID(e);if(!f)return;player.lcPlayer.removeTeammate(f)}}if(d.includes("has disbanded the party!")&&(partyMembers=[],player.lcPlayer.removeAllTeammates()),d.includes("You have joined")&&d.includes("party!")&&setTimeout(()=>player.executeCommand("/p list"),1e3),d.includes("Party Leader:")){var e=d.split(" ");if(e=e.splice(e[0].startsWith("[")?4:3,e.length-(e[0].startsWith("[")?5:4)).join(" "),partyMembers=[],player.lcPlayer.removeAllTeammates(),partyMembers.push(e),config.modules.PartyView){var f=getUUID(e);if(!f)return;player.lcPlayer.addTeammate(f)}}if(d.includes("Party Moderators:")||d.includes("Party Members:")){var g=d.split(" ");if(g=g.splice(2,g.length).join(" ").split("\u25CF ").map(a=>a.split(" ").splice(g[0].startsWith("[")?2:1,g.length-(g[0].startsWith("[")?2:1)).join(" ")),partyMembers=[],partyMembers.push(g),config.modules.PartyView)for(var e of g){var f=getUUID(e);if(!f)return;player.lcPlayer.addTeammate(f)}}}}),setInterval(async()=>{oldConfig=config,config=await toolbox.getConfig(),JSON.stringify(oldConfig)!=JSON.stringify(config)&&(config.modules.PartyView?partyMembers.forEach(async a=>{var b=getUUID(a);b&&player.lcPlayer.addTeammate(b)}):player.lcPlayer.removeAllTeammates())},500)},module.onLocationUpdate=()=>{config.modules.PartyView?partyMembers.forEach(async a=>{var b=getUUID(a);b&&player.lcPlayer.addTeammate(b)}):player.lcPlayer.removeAllTeammates()},registerPlugin({name:"Party View",description:"View Your Party Members With LC Team View",version:"1.0.0",author:"TBHGodPro"}),registerPlayerModule(module);