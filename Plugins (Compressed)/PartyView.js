(()=>{var e=[],a={};function t(e){return{uuid:e}}async function r(e){var t=a[e];return t||(t=player.connectedPlayers.find((a=>a.name==e))?.uuid),t||(t=(await fetch(`https://api.mojang.com/users/profiles/minecraft/${e}`)).id),t}var l=toolbox.getConfigSync().modules.PartyView;const i=new toolbox.Item(397);i.meta=3,i.displayName="§rParty View",i.lore=["","§7Use The Lunar Client Team View","§7Mod To See Your Party Members","","§7Current: §"+(l?"aEnabled":"cDisabled")];const s=new toolbox.PlayerModule("Party View","View Your Party Members With LC Team View",i,"PartyView");s.customCode=()=>{player.proxy.on("incoming",(async(l,i,n,o)=>{if("chat"==i.name){var m=JSON.parse(l.message);m.extra??=[];var y=[m.text,...m.extra.map((e=>e.text))].join("");if(y.endsWith("joined the party.")){p=(p=y.split(" ")).splice(p[0].startsWith("[")?1:0,p.length-(p[0].startsWith("[")?4:3)).join(" "),e.push(p);var d=await r(p);if(a[p]=d,s.enabled){if(!d)return;player.lcPlayer?.addTeammate(t(d))}}if(y.endsWith("left the party.")&&!y.startsWith("You")&&(p=(p=y.split(" ")).splice(p[0].startsWith("[")?1:0,p.length-(p[0].startsWith("[")?4:3)).join(" "),e=e.filter((e=>e!=p)),delete a[p],s.enabled)){if(!(d=await r(p)))return;player.lcPlayer?.removeTeammate(t(d))}if((y.includes("has disbanded the party!")||y.includes("You left the party."))&&(e=[],a={},player.lcPlayer?.removeAllTeammates()),y.includes("You have joined")&&y.includes("party!")&&setTimeout((()=>player.executeCommand("/party list")),1e3),y.includes("Party Leader:")&&(p=(p=y.split(" ")).splice(p[0].startsWith("[")?4:3,p.length-(p[0].startsWith("[")?5:4)).join(" "),e=[],player.lcPlayer?.removeAllTeammates(),e.push(p),d=await r(p),a[p]=d,s.enabled)){if(!d)return;player.lcPlayer?.addTeammate(t(d))}if(y.includes("Party Moderators:")||y.includes("Party Members:")){var c=y.split(" ");for(var p of(c=c.splice(2,c.length).join(" ").split("● ").map((e=>e.split(" ").splice(c[0].startsWith("[")?2:1,c.length-(c[0].startsWith("[")?2:1)).join(" "))),e.push(c),c))d=await r(p),a[p]=d;if(s.enabled)for(var p of c){if(!(d=await r(p)))return;player.lcPlayer?.addTeammate(t(d))}y.includes("Party Members:")&&(a=Object.keys(a).filter((a=>e.includes(a))).map((e=>a[e])))}y.includes("You are not currently in a party.")&&(e=[],a={},player.lcPlayer?.removeAllTeammates())}}))},s.onConfigChange=async a=>{if(l=a,s.enabled)for(var i of(player.lcPlayer?.removeAllTeammates(),e)){var n=await r(i);if(!n)return;player.lcPlayer?.addTeammate(t(n))}else player.lcPlayer?.removeAllTeammates()},s.onLocationUpdate=()=>{setTimeout((()=>{s.enabled&&(player.lcPlayer?.removeAllTeammates(),setTimeout((async()=>{for(var a of e){var l=await r(a);if(!l)return;player.lcPlayer?.addTeammate(t(l))}}),500))}),1e3)},player.listener.on("player_join",((a,r)=>{s.enabled&&e.includes(r)&&a&&player.lcPlayer?.addTeammate(t(a))})),registerPlayerModule(s),registerPlugin({name:"Party View",description:"View Your Party Members With LC Team View | `/ss`",version:"1.4.3",author:"TBHGodPro"})})();